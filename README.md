[![doi](https://img.shields.io/badge/DOI-10.17605/OSF.IO/UYZ5H-blue)][doi]

[doi]: https://doi.org/10.17605/OSF.IO/UYZ5H

# LTR-MNM

## Purpose of the Repository
The repository **LTR-MNM** provides `R` code to calculate the Lifetime risk of maternal near miss (LTR-MNM). It combines simulated data on the age profile of the maternal near miss ratio (MNMRatio) with real data from the United Nations World Population Prospects 2022 (UNWPP). 
The default options refer to Namibia, a high-burden context with available evidence on MNMRatio for ages 15 to 49 combined. Users can adjust these default options to calculate LTR-MNM for a country of their liking. Results derived from the data and analysis files provided in this repository do not necessarily reflect the views of the United Nations.

## Repository Structure
The repository **LTR-MNM** contains two folders:

- **data**

	stores all data files necessary to calculate LTR-MNM

- **scripts** 

	contains all analysis files necessary to calculate LTR-MNM

## data
The folder **data** stores all data files necessary to calculate LTR-MNM. 

We use mortality and fertility data in five-year age groups provided by United Nations World Population Prospects 2022 (UNWPP). This data is provided in the three .zip files `WPP2022_Life_Table_Abridged_Medium_1950-2021.zip`, `WPP2022_Fertility_by_Age5.zip`, and `WPP2022_Demographic_Indicators_Medium.zip`. These .zip files do **not** need to be unzipped before running the analysis files in the **scripts** folder.

UNWPP 2022 data are distributed under a [Creative Commons license CC BY 3.0 IGO](https://creativecommons.org/licenses/by/3.0/igo/).  

Please note that data distributed by UNWPP may have been updated in the meantime. Users are therefore advised to download the necessary data files directly from [UNWPP](https://population.un.org/wpp/Download/Standard/CSV/). For data releases other than the 2022 version, file names and variable names may have to be adjusted in our analysis files. 

## scripts
The folder **scripts** contains all analysis files necessary to calculate LTR-MNM: 

### 00-main.R
This analysis file installs and loads the `R` packages required for the simulations and calculations. It defines the input information for the simulations/calculations (including the country-year and total MNMRatio) and saves this information in the data file `Input.RData` in the **data** folder. The data file `Input.RData` is used by all remaining analysis files (see below). `00-main.R` also runs all remaining analysis files.

### 01-preparation.R
This analysis file combines UNWPP mortality and fertility information for the country-year specified in the analysis file `00-main.R`. It saves in the folder **data** the data file `WPP-CNTRY-YR.RData`, which contains the list object `WPP.total`.

### 02-LTR-MNM_age-specific.R
This analysis file calculates age-specific MNM risks using simulated data on different age profiles (for five-year age intervals). It first calculates seven MNM risks at random and arranges these risks to conform with six age profiles: 'J-shape', 'Increasing', 'Decreasing', 'Constant', 'N-shape', and 'U-shape'. It then calculates the total cases implied by the total MNMRatio (as specified in the analysis file `00-main.R`) and adjusts the random age-specific risks for the different age profiles to conform with this total MNMRatio.

`02-LTR-MNM_age-specific.R` saves in the folder **data** the data file `LTR-byage-CNTRY-YR.RData`, which contains two objects: `ltr.byage`, which combines information on all simulated age profiles and the associated age-specific MNM risks; `ltr.byage.sum`, which combines information on LTR-MNM derived from the age-specific MNM risks for all simulated age profiles.  

### 03-LTR-MNM_aggregate.R
This analysis file calculates LTR-MNM using only summary data on MNMRatio for all reproductive ages (15 to 49) combined (as specified in the analysis file `00-main.R`). It saves in the folder **data** the data file `LTR-agg-CNTRY-YR.RData`, which contains the object `ltr.agg`. 

### 99-output.R
This analysis file uses as input the simulated age profiles generated by `02-LTR-MNM_age-specific.R`. It first plots the simulated age profiles and saves the plot as .pdf file (`MNMratio-CNRTY-YR.pdf`) to the automatically generated folder **out**. It then tabulates the age profiles, calculates LTR-MNM for each age profile and saves the table as .png file (`LTR-CNTRY-YR.png`) to the folder **out**. 

## How to Use the Repository
In order to run the `R` code provided in the repository **LTR-MNM**, please proceed in the following order:

1. Download the repository from `github`. If applicable, unzip the downloaded folder and place it in a location convenient for you. 
2. Double click on the file `LTR_MNM.Rproj`. This should open `RStudio` on your machine.  
3. Within `RStudio`, click on `File`/`Open File...` and select the analysis file `00-main.R` located in the **scripts** folder.
4. If applicable, change the input information to a country of your liking.
5. Run the code.

## License
This work is licensed under a
[Creative Commons Attribution 4.0 International License][cc-by].

[![CC BY 4.0][cc-by-image]][cc-by]

[cc-by]: http://creativecommons.org/licenses/by/4.0/
[cc-by-image]: https://i.creativecommons.org/l/by/4.0/88x31.png
[cc-by-shield]: https://img.shields.io/badge/License-CC%20BY%204.0-lightgrey.svg
